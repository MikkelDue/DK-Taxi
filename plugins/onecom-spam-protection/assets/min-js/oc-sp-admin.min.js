!function(g){let b={handleTabClick:function(e){var s=g(e).attr("data-tab");g(".onecom_tabs_panel").fadeOut("fast"),g(e).parent().find(".active").removeClass("active"),g(e).addClass("active"),g("#"+s).fadeIn("fast")},formSubmission:function(s){g(s).on("click",".oc-save",function(e){e.preventDefault();e=g(s).attr("id");g(this).siblings("#oc_sp_spinner").removeClass("success").addClass("is_active"),"sp-settings"==e?(g(this).val("Saving"),b.protectionForm(s,g(this))):"sp-advanced-settings"==e?(g(this).val("Saving"),b.advanceSettings(s,g(this))):"sp-diagnostics"==e?b.spamDiagnostics(s,g(this)):"sp-clear-logs"==e&&(g(this).val("Clearing"),b.spamClearlogs(s,g(this)))})},protectionForm:function(s,t){var e=document.forms["sp-protect-options"].elements,e={action:"oc_save_settings",checks:{oc_sp_accept:e.oc_sp_accept.checked,oc_sp_referrer:e.oc_sp_referrer.checked,oc_sp_long:e.oc_sp_long.checked,oc_sp_short:e.oc_sp_short.checked,oc_sp_bbcode:e.oc_sp_bbcode.checked,oc_sp_exploit:e.oc_sp_exploit.checked,oc_sp_quickres:e.oc_sp_quickres.checked,oc_max_login_val:e.oc_max_login_val.value,oc_block_time:e.oc_block_time.value,one_sp_nonce:e.one_sp_nonce.value}};g.post(ajaxurl,e,function(e){g(t).siblings("#oc_sp_spinner").removeClass("is_active"),e.success&&(g(t).siblings("#oc_sp_spinner").addClass("success"),g(s).parents().find(".notice-success").hide(),g("#oc-sp-success").fadeIn("slow"),g(s).find("input:submit").attr("disabled",!0),g(t).val("Save"),b.disableSubmit(),setTimeout(function(){g(t).siblings("#oc_sp_spinner").removeClass("success")},6e3))})},advanceSettings:function(e,s){let t=document.forms["sp-advanced-settings"].elements,i=t.oc_sp_whitelistuser.checked,o=t.oc_spwhitelistip.checked,n=t.oc_spbadusragent.checked,c=t.oc_sp_urlshort.checked,a=t.oc_sp_proburl.checked,l={action:"oc_save_advanced_settings",oc_sp_whitelistuser:i,oc_spbadusragent:n,oc_sp_urlshort:c,oc_sp_proburl:a,oc_spwhitelistip:o,one_sp_nonce:t.one_sp_nonce.value,whitelist_usernames:""!==t.oc_whitelist_usernames.value?t.oc_whitelist_usernames.value.split("\n"):"",whitelist_ips:""!==t.oc_whitelist_ips.value?t.oc_whitelist_ips.value.split("\n"):"",whitelist_agents:""!==t.oc_whitelist_useragent.value?t.oc_whitelist_useragent.value.split("\n"):"",url_shorteners:""!==t.oc_url_shorters.value?t.oc_url_shorters.value.split("\n"):"",exploit_urls:""!==t.oc_exploit_urls.value?t.oc_exploit_urls.value.split("\n"):""};i||delete l.whitelist_usernames,o||delete l.whitelist_ips,n||delete l.whitelist_agents,c||delete l.url_shorteners,a||delete l.exploit_urls,b.executeAjaxRequest(e,l,s)},executeAjaxRequest:function(s,e,t){g.post(ajaxurl,e,function(e){g(t).siblings("#oc_sp_spinner").removeClass("is_active"),e.success&&(g(t).siblings("#oc_sp_spinner").addClass("success"),g(s).parents().find(".notice-success").hide(),g(s).parents().find(".advanced-settings").fadeIn("slow"),g(s).find("input:submit").attr("disabled",!0),g(t).val("Save"),b.disableSubmit(),setTimeout(function(){g(t).siblings("#oc_sp_spinner").removeClass("success")},6e3))})},spamDiagnostics:function(s,t){g(t).val("Checking");let e=document.forms["sp-diagnostics"].elements,i=g(s),o=i.parent().find(".oc-dg-err");var n=i.find(":input").filter(function(){return""===g.trim(this.value)});if(5===n.length&&0==o.length)i.parent().prepend('<div class="notice notice-error oc-dg-err"><p class="error">'+onespnotice.oc_notice+"</p></div>"),g(t).siblings("#oc_sp_spinner").removeClass("is_active"),g(t).val("Check for spam");else{if(5===n.length&&0<o.length)return g(t).siblings("#oc_sp_spinner").removeClass("is_active"),g(t).val("Check for spam"),!1;g(s).find("input:submit").attr("disabled",!0),g(s).parents().find(".oc-dg-err").remove();n={action:"oc_check_spam_diagnostics",oc_validate_ip:e.oc_validate_ip.value,oc_validate_user:e.oc_validate_user.value,oc_validate_email:e.oc_validate_email.value,oc_validate_user_agent:e.oc_validate_user_agent.value,oc_validate_content:e.oc_validate_content.value,one_sp_nonce:e.one_sp_nonce.value};g.post(ajaxurl,n,function(e){g(t).siblings("#oc_sp_spinner").removeClass("is_active"),e.success&&(g(t).siblings("#oc_sp_spinner").addClass("success"),g(s).parents().find(".ocdg-results").html(e.data),g(s).find("input:submit").attr("disabled",!1),g(s)[0].reset(),g(t).val("Check for spam"),setTimeout(function(){g(t).siblings("#oc_sp_spinner").removeClass("success")},6e3))})}},spamClearlogs:function(s,t){g(s).find("input:submit").attr("disabled",!0);var e={action:"oc_clear_spam_logs",one_sp_nonce:g(s).find(".one_sp_nonce").val()};g.post(ajaxurl,e,function(e){g(t).siblings("#oc_sp_spinner").removeClass("is_active"),e.success&&(g(s).parents().find(".notice-success").hide(),g(t).siblings("#oc_sp_spinner").addClass("success"),g(s).parents().find(".one-sp-logs").html(e.data),g(s).find("input:submit").attr("disabled",!1))})},disableSubmit:function(){var e=[g("form.sp-protect-options"),g("form.sp-blocked-lists")],e=g.map(e,function(e){return e.get()});g(e).each(function(){g(this).data("serialized",g(this).serialize())}).on("change input",function(){g(this).find("input:submit").attr("disabled",g(this).serialize()==g(this).data("serialized"))}).find("input:submit, button:submit").attr("disabled",!0)},disableTextArea:function(e,s,t=""){e&&!0===e.prop("checked")?(s.prop("disabled",!1).css("background","#ffffff"),""!==t&&t.prop("disabled",!1).css("background","#ffffff")):e&&!0!==e.prop("checked")&&(s.prop("disabled",!0).css("background","#f0f0f1"),""!==t&&t.prop("disabled",!0).css("background","#f0f0f1"))},toggleOnChange:function(e,s,t=""){e.on("change",function(){var e=g(this).prop("checked");s.prop("disabled",!e),""!==t&&t.prop("disabled",!e),e?(s.css("background","#ffffff"),""!==t&&t.css("background","#ffffff")):(s.css("background","#f0f0f1"),""!==t&&t.css("background","#f0f0f1"))})}};g(document).ready(function(){g(".onecom_tab").click(function(e){b.handleTabClick(g(this)),g(".onecom_tab.active").data("tab")}),g(".oc-duration-filter").change(function(e){const s=g(this);if(s.hasClass("disabled-section"))return!1;g(".filter-summary ul li").removeClass("active"),s.parent().hasClass("active")||s.parent().addClass("active");var t={action:"oc_get_summary",duration:g("option:selected",this).data("duration")};g("span#oc_switch_spinner").css("visibility","visible");const i=g(".oc-summary-body").find(".oc_total_count"),o=g(".oc-summary-body").find(".oc_comment_count"),n=g(".oc-summary-body").find(".oc_registration_count"),c=g(".oc-summary-body").find(".oc_failed_login_count"),a=g(".oc-summary-body").find(".oc_other_count");g.post(ajaxurl,t,function(e){i.html(e.total_count),o.html(e.comments_count),n.html(e.registration_count),c.html(e.failed_login),a.html(e.other_count),g("#oc_switch_spinner").css("visibility","hidden")})});const e=g(".sp-blocked-lists"),s=e.find("#spbadusragent"),t=e.find("#spurlshort"),i=e.find("#spprobchk"),o=e.find("#spwhitelistusername"),n=e.find("#spwhitelistIP"),c=e.find(".oc_whitelist_usernames"),a=e.find(".oc-whitelist-ip"),l=e.find(".oc-whitelist-useragent"),r=e.find(".oc-url-shorters"),d=e.find(".oc-exploit-urls"),u=g("#spquickres"),_=g(".oc_max_login_val"),p=g(".oc_block_time");if(b.disableTextArea(o,c),b.disableTextArea(n,a),b.disableTextArea(s,l),b.disableTextArea(t,r),b.disableTextArea(i,d),b.disableTextArea(u,_,p),b.toggleOnChange(o,c),b.toggleOnChange(n,a),b.toggleOnChange(s,l),b.toggleOnChange(t,r),b.toggleOnChange(i,d),b.toggleOnChange(u,_,p),g(".oc-show-modal").on("click",function(e){e.preventDefault(),jQuery.ajax({url:ajaxurl,type:"POST",data:{action:"show_plugin_dependent_popup",popupContent:onespnotice.popupContent},success:function(e){void 0!==e.success&&!0===e.success&&(g("#oc_um_overlay").html(e.data),e=location.search,g("#oc_um_overlay").show(),ocSetModalData({isPremium:!0,feature:"spam_protection",featureAction:"getStarted",referrer:e}))},error:function(e,s,t){}})}),0===document.getElementsByClassName("disabled-section").length){let e=new IntersectionObserver(function(e){!0===e[0].isIntersecting?(g(".oc-sp-float-btn").hide(),g(".float-spinner").removeClass("success").hide()):(g(".oc-sp-float-btn").show(),g(".float-spinner").show())},{threshold:[0]});e.observe(document.querySelector("#onecom-sp-ui #settings .oc-save")),e.observe(document.querySelector("#onecom-sp-ui #advanced_settings .oc-save"))}var f=g("#onecom-sp-ui").find("form.sp-protect-options"),m=g("#onecom-sp-ui").find("form.sp-blocked-lists"),h=g("#onecom-sp-ui").find("form.sp-diagnostics"),v=g("#onecom-sp-ui").find("form#sp-clear-logs");b.formSubmission(f),b.formSubmission(m),b.formSubmission(h),b.formSubmission(v),b.disableSubmit()})}(jQuery);